# Multi-Agent Systems Exam Projects

This repository contains implementations for two projects from the 2025 MAS (Multi-Agent Systems) course:

1. **Parameter Identification for Discrete-Time Markov Chains (DTMCs)**
2. **Multi-Agent Reinforcement Learning on Stochastic Games** - Simplified Football Game

## Project 1: Parameter Identification for DTMCs

### Overview
This project focuses on estimating parameters of a two-state Discrete-Time Markov Chain (DTMC) that models system switching behavior between states A and B.

### Problem Setting
- **System Model**: Two-state DTMC with transition matrix:
  ```
  P = [1-p  p  ]
      [q    1-q]
  ```
- **Observations**: Finite traces of state sequences (e.g., A → B → A → A → B)
- **Goal**: Estimate parameters p and q from observed data

### Key Features
- **Maximum Likelihood Estimation (MLE)** implementation with detailed derivation
- **Synthetic data generation** for validation with known ground truth parameters
- **Statistical analysis** of estimation quality vs. number of observations
- **Confidence interval computation** and convergence analysis
- **Comparative evaluation** of different parameter inference techniques

### Implementation Highlights
- Parameter estimation algorithms for two-state DTMCs
- Likelihood function derivation and optimization
- Monte Carlo simulation for performance evaluation
- Visualization of parameter convergence and confidence regions

### Files Structure
```
DTMC
├── DTMC.ipynb
└── plots/         # Directory for generated plots
```

## Project 2: Multi-Agent Reinforcement Learning - Simplified Football

### Overview
Implementation of belief-based joint action learning for a two-player zero-sum stochastic game based on Littman's simplified football environment.

### Game Setting
- **Environment**: 4×5 grid football field
- **Players**: Two agents (A and B) with opposing goals
- **Actions**: North, South, East, West, Stand (5 actions per player)
- **Objective**: Score in opponent's goal area while defending own goal
- **Ball Mechanics**: Possession changes through strategic positioning and collisions

### Key Features
- **Belief-based Joint Action Learning** algorithm implementation
- **Behavioral strategies** with frequency-based opponent modeling
- **Multi-agent training** against random and learning opponents
- **Performance evaluation** over 10⁶ training steps and 10⁵ testing steps
- **Comparative analysis** with literature benchmarks

### Algorithm Parameters
```python
epsilon = 0.2                    # Exploration rate
alpha_0 = 1.0                   # Initial learning rate
alpha_decay = 0.9999954         # Learning rate decay
gamma = 0.9                     # Discount factor
termination_prob = 0.1          # Game termination probability
```

### Implementation Highlights
- Stochastic game environment with proper state representation
- Belief update mechanisms for opponent modeling
- Policy learning with behavioral strategies
- Statistical evaluation against random and learning opponents

### Files Structure
```
MARL/
├── football_analysis.ipynb
├── FootballRL
│   ├── agent.py
│   ├── environment.py
│   └── __init__.py
├── results
│   ├── plots/         # Directory for generated plots
│   └── simulations.csv
└── simulations.py
```

## Installation and Setup

### Requirements
```bash
pip install numpy scipy matplotlib pandas seaborn
```

### Running the Projects

#### DTMC Parameter Inference
For this project, run the Jupyter notebook to explore the parameter estimation process.

#### MARL Football Game
Run the `simulations.py` script to execute the multi-agent reinforcement learning training and evaluation. The results will be saved in the `results` directory.
For all the plots and analysis, refer to the `football_analysis.ipynb` notebook, which is based on the results generated by the simulations.

## References

### DTMC Project
- Goodman, L. A. (1965). *On the estimation of probabilities in multistate Markov models*. Journal of the American Statistical Association, 60(310), 310-320.
- Norris, J. R. (1998). *Markov Chains*. Cambridge University Press.
- Bishop, C. M. (2006). *Pattern Recognition and Machine Learning*. Springer.

### MARL Project
Littman, M. L. (1994). *Markov games as a framework for multi-agent reinforcement learning*. Proceedings of the 11th International Conference on Machine Learning (ICML), 157-163.
Albrecht, S. V., Christianos, F., & Schäfer, L. (2024). *Multi-Agent Reinforcement Learning: Foundations and Modern Approaches*. MIT Press.

## Course Information
- **Course**: Multi-Agent Systems 2025
- **Instructor**: Tatjana Petrov & Tommaso Padoan
- **Institution**: University of Trieste